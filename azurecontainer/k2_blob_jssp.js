metadata={systemName:"com.k2.mrohstorage",displayName:"MROH File Download Broker",description:"A broker for downloading files from MROH Azure Blob Storage."};const e="https://mrohstoragetechrefdev01.blob.core.windows.net",r="/Technical%20Reference/Work%20Orders/2025-298/2025-0394872/References",t="file",o="content",s="fileName",i="path",n="download";ondescribe=async function({configuration:e}){postSchema({objects:{[t]:{displayName:"File",description:"Download files from Azure Blob Storage",properties:{[o]:{displayName:"File Content",type:"string"},[s]:{displayName:"File Name",type:"string"}},methods:{[n]:{displayName:"Download File",type:"read",outputs:[o,s],parameters:{[i]:{displayName:"File Path",description:"Path to the file in blob storage",type:"string"}},requiredParameters:[i]}}}},configuration:{serviceKeyProperties:{"x-ms-version":{displayName:"Azure Storage API Version (x-ms-version)",description:"Optional override for the x-ms-version header sent to Azure Storage",type:"string",default:"2020-04-08"}}}})},onexecute=async function({objectName:a,methodName:p,parameters:c,properties:d,configuration:l}){if(a!==t)throw new Error("The object "+a+" is not supported.");await async function(t,a,p,c){if(t!==n)throw new Error("The method "+t+" is not supported.");await function(t,n,a){return new Promise(((n,p)=>{if("string"!=typeof t[i])throw new Error('parameters["path"] is not of type string');t[i],function(t,n,a,p){const c=t[i],d=`${e}${r}/${c}`;!function(e,r,t,o,s){var i=new XMLHttpRequest;let n;i.onreadystatechange=function(){try{if(4!==i.readyState)return;if(200!==i.status)throw new Error("Failed with status "+i.status);s(null,i.responseText)}catch(e){s(e)}},i.open(t,e);try{o&&"string"==typeof o.xMsVersion?n=o.xMsVersion:o&&o.serviceKeyProperties&&"string"==typeof o.serviceKeyProperties["x-ms-version"]?n=o.serviceKeyProperties["x-ms-version"]:o&&o.serviceProperties&&"string"==typeof o.serviceProperties["x-ms-version"]&&(n=o.serviceProperties["x-ms-version"])}catch{}const a=n||"2020-04-08";i.setRequestHeader("x-ms-version",a),i.send(r)}(d,"","GET",a,((e,r)=>{if(e)return p(e);const t=c.includes("/")&&c.split("/").pop()||c;p(null,{[o]:r,[s]:t})}))}(t,0,a,((e,r)=>{if(e)return p(e);postResult(r),n()}))}))}(a,0,c)}(p,c,0,l)};
