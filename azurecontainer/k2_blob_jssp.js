metadata={systemName:"com.k2.mrohstorage",displayName:"MROH File Download Broker",description:"A broker for downloading files from MROH Azure Blob Storage."};const e="https://mrohstoragetechrefdev01.blob.core.windows.net",t="/Technical%20Reference/Work%20Orders/2025-298/2025-0394872/References",r="file",o="content",s="fileName",i="path",n="download";ondescribe=async function({configuration:e}){postSchema({objects:{[r]:{displayName:"File",description:"Download files from Azure Blob Storage",properties:{[o]:{displayName:"File Content",type:"string"},[s]:{displayName:"File Name",type:"string"}},methods:{[n]:{displayName:"Download File",type:"read",outputs:[o,s],parameters:{[i]:{displayName:"File Path",description:"Path to the file in blob storage",type:"string"}},requiredParameters:[i]}}}}})},onexecute=async function({objectName:a,methodName:p,parameters:c,properties:l,configuration:d}){if(a!==r)throw new Error("The object "+a+" is not supported.");await async function(r,a,p,c){if(r!==n)throw new Error("The method "+r+" is not supported.");await function(r,n,a){return new Promise(((n,p)=>{if("string"!=typeof r[i])throw new Error('parameters["path"] is not of type string');r[i],function(r,n,a,p){const c=r[i],l=`${e}${t}/${c}`;!function(e,t,r,o,s){var i=new XMLHttpRequest;let n;i.onreadystatechange=function(){try{if(4!==i.readyState)return;if(200!==i.status)throw new Error("Failed with status "+i.status);s(null,i.responseText)}catch(e){s(e)}},i.open(r,e);try{o&&"string"==typeof o.xMsVersion?n=o.xMsVersion:o&&o.serviceKeyProperties&&"string"==typeof o.serviceKeyProperties["x-ms-version"]?n=o.serviceKeyProperties["x-ms-version"]:o&&o.serviceProperties&&"string"==typeof o.serviceProperties["x-ms-version"]&&(n=o.serviceProperties["x-ms-version"])}catch{}const a=n||"2020-04-08";i.setRequestHeader("x-ms-version",a),i.send(t)}(l,"","GET",a,((e,t)=>{if(e)return p(e);const r=c.includes("/")&&c.split("/").pop()||c;p(null,{[o]:t,[s]:r})}))}(r,0,a,((e,t)=>{if(e)return p(e);postResult(t),n()}))}))}(a,0,c)}(p,c,0,d)};
