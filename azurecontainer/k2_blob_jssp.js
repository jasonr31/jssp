metadata={systemName:"com.k2.mrohstorage",displayName:"MROH File Download Broker",description:"A broker for downloading files from MROH Azure Blob Storage."};const e="https://mrohstoragetechrefdev01.blob.core.windows.net",t="/Technical%20Reference/Work%20Orders/2025-298/2025-0394872/References",o="file",r="content",n="fileName",a="path",i="download";ondescribe=async function({configuration:e}){postSchema({objects:{[o]:{displayName:"File",description:"Download files from Azure Blob Storage",properties:{[r]:{displayName:"File Content",type:"string"},[n]:{displayName:"File Name",type:"string"}},methods:{[i]:{displayName:"Download File",type:"read",outputs:[r,n],parameters:{[a]:{displayName:"File Path",description:"Path to the file in blob storage",type:"string"}},requiredParameters:[a]}}}}})},onexecute=async function({objectName:s,methodName:p,parameters:c,properties:l,configuration:d}){if(s!==o)throw new Error("The object "+s+" is not supported.");await async function(o,s){if(o!==i)throw new Error("The method "+o+" is not supported.");await function(o){return new Promise(((i,s)=>{if("string"!=typeof o[a])throw new Error('parameters["path"] is not of type string');o[a],function(o,i,s){const p=o[a],c=`${e}${t}/${p}`;!function(e,t,o,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){try{if(4!==n.readyState)return;if(200!==n.status)throw new Error("Failed with status "+n.status);r(null,n.responseText)}catch(e){r(e)}},n.open(o,e),n.send(t)}(c,"","GET",((e,t)=>{if(e)return s(e);const o=p.includes("/")&&p.split("/").pop()||p;s(null,{[r]:t,[n]:o})}))}(o,0,((e,t)=>{if(e)return s(e);postResult(t),i()}))}))}(s)}(p,c)};
